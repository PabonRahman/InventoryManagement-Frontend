<div class="container-fluid mt-4">
  <!-- Header Section -->
  <div class="row mb-4">
    <div class="col">
      <div class="d-flex justify-content-between align-items-center">
        <div>
          <h2><i class="fas fa-truck me-2"></i>Supplier Management</h2>
          <p class="text-muted mb-0">Manage your product suppliers and vendors</p>
        </div>
        <button class="btn btn-primary" (click)="addNewSupplier()">
          <i class="fas fa-plus me-2"></i>Add New Supplier
        </button>
      </div>
    </div>
  </div>

  <!-- Search and Filters Section -->
  <div class="card mb-4">
    <div class="card-body">
      <div class="row align-items-end">
        <div class="col-md-8">
          <label for="search" class="form-label">Search Suppliers</label>
          <div class="input-group">
            <span class="input-group-text">
              <i class="fas fa-search"></i>
            </span>
            <input
              type="text"
              class="form-control"
              id="search"
              placeholder="Search by name, email, phone, or address..."
              [(ngModel)]="searchTerm"
              (input)="onSearchChange()">
            <button 
              *ngIf="searchTerm" 
              class="btn btn-outline-secondary" 
              type="button"
              (click)="clearSearch()">
              <i class="fas fa-times"></i>
            </button>
          </div>
        </div>
        <div class="col-md-4">
          <div class="d-flex justify-content-end align-items-center">
            <div class="text-muted me-3">
              <small>{{ filteredSuppliers.length }} suppliers found</small>
            </div>
            <div class="d-flex align-items-center">
              <label class="me-2 small text-muted">Show:</label>
              <select 
                class="form-select form-select-sm w-auto" 
                [(ngModel)]="pageSize"
                (change)="onPageSizeChange()">
                <option value="5">5</option>
                <option value="10">10</option>
                <option value="20">20</option>
                <option value="50">50</option>
              </select>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="text-center py-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p class="mt-2 text-muted">Loading suppliers...</p>
  </div>

  <!-- Suppliers Table -->
  <div *ngIf="!loading" class="card">
    <div class="card-header d-flex justify-content-between align-items-center">
      <h5 class="mb-0">
        <i class="fas fa-list me-2"></i>Suppliers
        <span class="badge bg-secondary ms-2">{{ totalItems }}</span>
      </h5>
      <div class="d-flex align-items-center gap-2">
        <small class="text-muted me-3">
          Showing {{ paginatedSuppliers.length }} of {{ totalItems }}
        </small>
        <button class="btn btn-sm btn-outline-secondary" (click)="refreshSuppliers()" title="Refresh suppliers">
          <i class="fas fa-sync-alt"></i>
        </button>
      </div>
    </div>

    <div class="card-body p-0">
      <div class="table-responsive">
        <table class="table table-hover mb-0">
          <thead class="table-light">
            <tr>
              <th width="60">#</th>
              <th>Supplier Name</th>
              <th>Contact Email</th>
              <th>Phone</th>
              <th>Address</th>
              <th class="text-center">Products</th>
              <th class="text-center">Status</th>
              <th width="200" class="text-center">Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let supplier of paginatedSuppliers; let i = index" class="align-middle">
              <td class="text-muted">
                <small>{{ (currentPage - 1) * pageSize + i + 1 }}</small>
              </td>
              
              <td>
                <div class="fw-semibold text-primary">{{ supplier.name }}</div>
              </td>
              
              <td>
                <small [class.text-muted]="!supplier.contactEmail">
                  <i class="fas fa-envelope me-1"></i>
                  {{ getDisplayEmail(supplier) }}
                </small>
              </td>
              
              <td>
                <small>
                  <i class="fas fa-phone me-1"></i>
                  {{ formatPhone(supplier.phone) }}
                </small>
              </td>
              
              <td>
                <small [class.text-muted]="!supplier.address" class="text-truncate d-inline-block" style="max-width: 200px;">
                  <i class="fas fa-map-marker-alt me-1"></i>
                  {{ getDisplayAddress(supplier) }}
                </small>
              </td>
              
              <td class="text-center">
                <span class="badge" [class]="hasProducts(supplier) ? 'bg-warning text-dark' : 'bg-light text-dark'">
                  <i class="fas fa-box me-1"></i>
                  {{ getProductCountText(supplier) }}
                </span>
              </td>
              
              <td class="text-center">
                <span class="badge" [class]="getSupplierStatus(supplier).class">
                  {{ getSupplierStatus(supplier).text }}
                </span>
              </td>
              
              <td class="text-center">
                <div class="btn-group btn-group-sm" role="group">
                  <button class="btn btn-outline-primary" 
                          (click)="viewSupplier(supplier)" 
                          title="View Supplier Details">
                    <i class="fas fa-eye"></i>
                  </button>
                  <button class="btn btn-outline-warning" 
                          (click)="editSupplier(supplier)" 
                          title="Edit Supplier">
                    <i class="fas fa-edit"></i>
                  </button>
                  <button class="btn btn-outline-danger" 
                          (click)="deleteSupplier(supplier)"
                          [disabled]="deleting && deleteSupplierId === supplier.id" 
                          [title]="hasProducts(supplier) ? 'Supplier has ' + getProductCountText(supplier) : 'Delete Supplier'"
                          [class.pe-none]="deleting && deleteSupplierId === supplier.id">
                    <span *ngIf="deleting && deleteSupplierId === supplier.id" 
                          class="spinner-border spinner-border-sm me-1"></span>
                    <i class="fas fa-trash"></i>
                  </button>
                </div>
              </td>
            </tr>

            <!-- Empty State -->
            <tr *ngIf="filteredSuppliers.length === 0">
              <td colspan="8" class="text-center py-5">
                <div class="text-muted">
                  <i class="fas fa-truck fa-4x mb-3 opacity-50"></i>
                  <h4>No suppliers found</h4>
                  <p *ngIf="searchTerm" class="mb-4">
                    No suppliers match "<strong>{{ searchTerm }}</strong>". Try adjusting your search terms.
                  </p>
                  <div *ngIf="!searchTerm" class="mb-4">
                    <p>Get started by adding your first supplier to the system.</p>
                    <p class="small">Suppliers help you manage product sourcing and vendor relationships.</p>
                  </div>
                  <button class="btn btn-primary btn-lg" (click)="addNewSupplier()">
                    <i class="fas fa-plus me-2"></i>Add Your First Supplier
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Pagination -->
    <div *ngIf="totalPages > 1" class="card-footer">
      <div class="row align-items-center">
        <div class="col-md-6">
          <small class="text-muted">
            Page {{ currentPage }} of {{ totalPages }} â€¢ 
            {{ totalItems }} total suppliers
          </small>
        </div>
        <div class="col-md-6">
          <nav aria-label="Supplier pagination">
            <ul class="pagination justify-content-end mb-0">
              <li class="page-item" [class.disabled]="currentPage === 1">
                <a class="page-link" href="javascript:void(0)" (click)="goToPage(currentPage - 1)">
                  <i class="fas fa-chevron-left me-1"></i>Previous
                </a>
              </li>
              
              <li *ngFor="let page of pages" class="page-item" [class.active]="page === currentPage">
                <a class="page-link" href="javascript:void(0)" (click)="goToPage(page)">
                  {{ page }}
                </a>
              </li>
              
              <li class="page-item" [class.disabled]="currentPage === totalPages">
                <a class="page-link" href="javascript:void(0)" (click)="goToPage(currentPage + 1)">
                  Next<i class="fas fa-chevron-right ms-1"></i>
                </a>
              </li>
            </ul>
          </nav>
        </div>
      </div>
    </div>
  </div>
</div>